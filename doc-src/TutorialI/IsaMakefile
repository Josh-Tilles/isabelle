#
# IsaMakefile for Tutorial
#

## targets

default: HOL-ToyList HOL-Ifexpr HOL-CodeGen HOL-Trie HOL-Datatype HOL-Recdef HOL-Misc styles
images:
test:
all: default


## global settings

SRC = $(ISABELLE_HOME)/src
OUT = $(ISABELLE_OUTPUT)
LOG = $(OUT)/log


## HOL

HOL:
	@cd $(SRC)/HOL; $(ISATOOL) make HOL

styles:
	@$(ISATOOL) latex -o sty >/dev/null
	@rm -f pdfsetup.sty
	@rm -f */document/isabelle.sty
	@rm -f */document/isabellesym.sty
	@rm -f */document/pdfsetup.sty


## HOL-Ifexpr

HOL-Ifexpr: HOL $(LOG)/HOL-Ifexpr.gz

$(LOG)/HOL-Ifexpr.gz: $(OUT)/HOL Ifexpr/Ifexpr.thy Ifexpr/ROOT.ML
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL Ifexpr
	@rm -f tutorial.dvi

## HOL-ToyList

HOL-ToyList: HOL $(LOG)/HOL-ToyList.gz $(LOG)/HOL-ToyList2.gz

ToyList2/ToyList.thy: ToyList2/ToyList1 ToyList2/ToyList2
	cat ToyList2/ToyList1 ToyList2/ToyList2 > ToyList2/ToyList.thy

$(LOG)/HOL-ToyList2.gz: $(OUT)/HOL ToyList2/ToyList.thy ToyList2/ROOT.ML
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL ToyList2
	@rm -f tutorial.dvi

$(LOG)/HOL-ToyList.gz: $(OUT)/HOL ToyList/ToyList.thy ToyList/ROOT.ML
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL ToyList
	@rm -f tutorial.dvi

## HOL-CodeGen

HOL-CodeGen: HOL $(LOG)/HOL-CodeGen.gz

$(LOG)/HOL-CodeGen.gz: $(OUT)/HOL CodeGen/CodeGen.thy
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL CodeGen
	@rm -f tutorial.dvi


## HOL-Datatype

HOL-Datatype: HOL $(LOG)/HOL-Datatype.gz

$(LOG)/HOL-Datatype.gz: $(OUT)/HOL Datatype/ROOT.ML Datatype/ABexpr.thy \
  Datatype/Nested.thy Datatype/unfoldnested.thy \
  Datatype/Fundata.thy
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL Datatype
	@rm -f tutorial.dvi


## HOL-Trie

HOL-Trie: HOL $(LOG)/HOL-Trie.gz

$(LOG)/HOL-Trie.gz: $(OUT)/HOL Trie/Option2.thy Trie/Trie.thy
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL Trie
	@rm -f tutorial.dvi


## HOL-Recdef

HOL-Recdef: HOL $(LOG)/HOL-Recdef.gz

$(LOG)/HOL-Recdef.gz: $(OUT)/HOL Recdef/examples.thy Recdef/termination.thy \
  Recdef/simplification.thy Recdef/Induction.thy \
  Recdef/Nested0.thy Recdef/Nested1.thy Recdef/Nested2.thy
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL Recdef
	@rm -f tutorial.dvi


## HOL-Misc

HOL-Misc: HOL $(LOG)/HOL-Misc.gz

$(LOG)/HOL-Misc.gz: $(OUT)/HOL Misc/ROOT.ML Misc/Tree.thy Misc/Tree2.thy Misc/cases.thy \
  Misc/fakenat.thy Misc/natsum.thy Misc/pairs.thy Misc/types.thy \
  Misc/prime_def.thy Misc/case_exprs.thy \
  Misc/arith1.thy Misc/arith2.thy Misc/arith3.thy Misc/arith4.thy \
  Misc/def_rewr.thy Misc/let_rewr.thy Misc/cond_rewr.thy Misc/case_splits.thy \
  Misc/trace_simp.thy Misc/Itrev.thy Misc/AdvancedInd.thy Misc/asm_simp.thy
	@$(ISATOOL) usedir -i true -d dvi -D document $(OUT)/HOL Misc
	@rm -f tutorial.dvi


## clean

clean:
	@rm -f tutorial.dvi $(LOG)/HOL-Ifexpr.gz $(LOG)/HOL-CodeGen.gz $(LOG)/HOL-Misc.gz $(LOG)/HOL-ToyList.gz $(LOG)/HOL-ToyList2.gz $(LOG)/HOL-Trie.gz $(LOG)/HOL-Datatype.gz $(LOG)/HOL-Recdef.gz
